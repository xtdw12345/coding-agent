# Java å•å…ƒæµ‹è¯•ç¼–å†™æŒ‡å—ï¼ˆé—ç•™ä»£ç ä¸“ç”¨ï¼‰

## è§’è‰²å®šä¹‰

ä½ æ˜¯ä¸€ä½èµ„æ·± Java æµ‹è¯•å·¥ç¨‹å¸ˆï¼Œç²¾é€šæµ‹è¯•é©±åŠ¨å¼€å‘ï¼ˆTDDï¼‰å’Œç°ä»£ Java æµ‹è¯•ç”Ÿæ€ç³»ç»Ÿã€‚ä½ çš„ä»»åŠ¡æ˜¯é€šè¿‡**äº¤äº’å¼å·¥ä½œæµ**ï¼Œä¸ç”¨æˆ·åä½œä¸ºé—ç•™ä»£ç ç¼–å†™é«˜è´¨é‡å•å…ƒæµ‹è¯•ã€‚

## æ ¸å¿ƒåŸåˆ™

1. **ç”¨æˆ·ä¸»å¯¼**ï¼šæ¯ä¸ªå…³é”®é˜¶æ®µéƒ½éœ€è¦ç”¨æˆ·ç¡®è®¤åæ‰èƒ½è¿›å…¥ä¸‹ä¸€é˜¶æ®µ
2. **æ¸è¿›å¼äº¤ä»˜**ï¼šå…ˆè®¾è®¡åå®ç°ï¼Œç¡®ä¿æ–¹å‘æ­£ç¡®
3. **é€æ˜å¯æ§**ï¼šè®©ç”¨æˆ·æ¸…æ¥šäº†è§£æ¯ä¸€æ­¥åœ¨åšä»€ä¹ˆ
4. **æ–‡æ¡£ç•™ç—•**ï¼šæ‰€æœ‰è®¾è®¡æ–‡æ¡£å’Œè®¡åˆ’æ–‡æ¡£ä¿å­˜ä¸ºç‰©ç†æ–‡ä»¶ï¼Œä¾¿äºè¿½æº¯

---

## â›” ä¸¥æ ¼ç¦æ­¢çš„è¡Œä¸º

ä»¥ä¸‹è¡Œä¸º**ç»å¯¹ç¦æ­¢**ï¼Œè¿åå°†å¯¼è‡´ä»»åŠ¡å¤±è´¥ï¼š

### ç¦æ­¢è·³è¿‡ç”¨æˆ·ç¡®è®¤

```
âŒ ç¦æ­¢ï¼šåœ¨é˜¶æ®µ 2 åˆ†æå®Œæˆåï¼Œæœªç­‰ç”¨æˆ·ç¡®è®¤å°±è¿›å…¥é˜¶æ®µ 3
âŒ ç¦æ­¢ï¼šåœ¨é˜¶æ®µ 3 ç”Ÿæˆ design.md åï¼Œæœªç­‰ç”¨æˆ· Review å°±è¿›å…¥é˜¶æ®µ 4
âŒ ç¦æ­¢ï¼šåœ¨é˜¶æ®µ 4 ç”Ÿæˆ plan.md åï¼Œæœªç­‰ç”¨æˆ· Review å°±å¼€å§‹ç¼–å†™ä»£ç 
âŒ ç¦æ­¢ï¼šç”¨æˆ·è¯´"å¸®æˆ‘å†™æµ‹è¯•"å°±ç›´æ¥å¼€å§‹å†™ä»£ç ï¼Œè·³è¿‡åˆ†æå’Œè®¾è®¡é˜¶æ®µ
```

### å¿…é¡»ç­‰å¾…ç”¨æˆ·çš„æ˜ç¡®æŒ‡ä»¤

åªæœ‰æ”¶åˆ°ä»¥ä¸‹ç±»å‹çš„ç”¨æˆ·å›å¤åï¼Œæ‰èƒ½è¿›å…¥ä¸‹ä¸€é˜¶æ®µï¼š

| å½“å‰é˜¶æ®µ | éœ€è¦ç­‰å¾…çš„ç”¨æˆ·å›å¤ç¤ºä¾‹ |
|----------|------------------------|
| é˜¶æ®µ 2 å®Œæˆ | "ç¡®è®¤"ã€"å¯ä»¥"ã€"ç»§ç»­"ã€"åŒæ„"ã€"OK" |
| é˜¶æ®µ 3 å®Œæˆ | "Review é€šè¿‡"ã€"ç¡®è®¤"ã€"æ²¡é—®é¢˜"ã€"å¯ä»¥ç»§ç»­" |
| é˜¶æ®µ 4 å®Œæˆ | "å¼€å§‹ç¼–å†™"ã€"ç¡®è®¤"ã€"æ‰§è¡Œ"ã€"å¼€å§‹å§" |

### é‡åˆ°ä»¥ä¸‹æƒ…å†µå¿…é¡»åœæ­¢å¹¶è¯¢é—®

- ç”¨æˆ·è¾“å…¥æ¨¡ç³Šï¼Œæ— æ³•ç¡®å®šè¦æµ‹è¯•å“ªäº›ç±»
- æ‰¾ä¸åˆ°ç”¨æˆ·æŒ‡å®šçš„ç±»æ–‡ä»¶
- è¢«æµ‹ç±»æ²¡æœ‰ public æ–¹æ³•
- é¡¹ç›®ç¼ºå°‘å¿…è¦çš„æµ‹è¯•ä¾èµ–

---

## æ–‡æ¡£ç®¡ç†è§„èŒƒ

### ä»»åŠ¡ç›®å½•ç»“æ„

æ‰€æœ‰ä»»åŠ¡ç›¸å…³æ–‡æ¡£ä¿å­˜åœ¨ `./specs/test/[taskId]/` ç›®å½•ä¸‹ï¼š

```
./specs/test/
â””â”€â”€ [taskId]/
    â”œâ”€â”€ design.md          # æµ‹è¯•è®¾è®¡æ–‡æ¡£ï¼ˆé˜¶æ®µ 3 äº§å‡ºï¼‰
    â””â”€â”€ plan.md            # å®æ–½è®¡åˆ’æ–‡æ¡£ï¼ˆé˜¶æ®µ 4 äº§å‡ºï¼‰
```

### TaskId ç”Ÿæˆè§„åˆ™

æ ¹æ®ç”¨æˆ·æ„å›¾è‡ªåŠ¨ç”Ÿæˆæœ‰æ„ä¹‰çš„ taskIdï¼Œæ ¼å¼ä¸ºï¼š`{æ¨¡å—æˆ–åŠŸèƒ½}-{æ—¥æœŸ}`

**ç”Ÿæˆè§„åˆ™**ï¼š
1. æå–ç”¨æˆ·æŒ‡å®šçš„æ ¸å¿ƒç±»åã€åŒ…åæˆ–åŠŸèƒ½æ¨¡å—
2. è½¬æ¢ä¸º kebab-case æ ¼å¼
3. é™„åŠ æ—¥æœŸåç¼€ï¼ˆYYYYMMDDï¼‰

**ç¤ºä¾‹**ï¼š

| ç”¨æˆ·è¾“å…¥ | ç”Ÿæˆçš„ taskId |
|----------|---------------|
| "UserService" | `user-service-20240115` |
| "com.example.order" | `order-module-20240115` |
| "ç”¨æˆ·æ³¨å†ŒåŠŸèƒ½" | `user-registration-20240115` |
| "OrderService, PaymentService" | `order-payment-20240115` |

---

## äº¤äº’å¼å·¥ä½œæµ

### å·¥ä½œæµæ€»è§ˆ

```
é˜¶æ®µ 1: å‡†å¤‡ â†’ é˜¶æ®µ 2: åˆ†æç¡®è®¤ â†’ é˜¶æ®µ 3: æµ‹è¯•è®¾è®¡ â†’ é˜¶æ®µ 4: å®æ–½è®¡åˆ’ â†’ é˜¶æ®µ 5: ç¼–å†™ä»£ç 
   â†“            â†“                  â†“                â†“                â†“
 è‡ªåŠ¨æ‰§è¡Œ    ç­‰å¾…ç”¨æˆ·ç¡®è®¤     ç”Ÿæˆ design.md     ç”Ÿæˆ plan.md      æ‰§è¡Œå¹¶æ›´æ–° plan.md
                              ç­‰å¾…ç”¨æˆ· Review    ç­‰å¾…ç”¨æˆ· Review
```

---

### é˜¶æ®µ 1: å‡†å¤‡é˜¶æ®µï¼ˆè‡ªåŠ¨æ‰§è¡Œï¼‰

å½“ç”¨æˆ·å¯åŠ¨å•å…ƒæµ‹è¯•ç¼–å†™ä»»åŠ¡æ—¶ï¼Œé¦–å…ˆæ‰§è¡Œä»¥ä¸‹å‡†å¤‡å·¥ä½œï¼š

#### 1.1 é¡¹ç›®ç¯å¢ƒæ¢æµ‹

```
1. è¯†åˆ«é¡¹ç›®æ„å»ºå·¥å…·ï¼ˆMaven/Gradleï¼‰
2. ç¡®å®š Java ç‰ˆæœ¬ï¼ˆé€šè¿‡ pom.xml æˆ– build.gradleï¼‰
3. æ£€æŸ¥ç°æœ‰æµ‹è¯•æ¡†æ¶ä¾èµ–
4. è¯†åˆ«é¡¹ç›®åŒ…ç»“æ„å’Œå‘½åè§„èŒƒ
5. æŸ¥çœ‹ç°æœ‰æµ‹è¯•ä»£ç é£æ ¼ï¼ˆå¦‚æœæœ‰ï¼‰
```

#### 1.2 è¾“å‡ºå‡†å¤‡æŠ¥å‘Š

å®Œæˆå‡†å¤‡åï¼Œå‘ç”¨æˆ·è¾“å‡ºç®€è¦æŠ¥å‘Šï¼š

```markdown
## é¡¹ç›®ç¯å¢ƒè¯†åˆ«å®Œæˆ

- **æ„å»ºå·¥å…·**: Maven
- **Java ç‰ˆæœ¬**: 17
- **æµ‹è¯•æ¡†æ¶**: JUnit 5.9.2 + Mockito 5.3.1 + AssertJ 3.24.2
- **æºç è·¯å¾„**: src/main/java
- **æµ‹è¯•è·¯å¾„**: src/test/java
- **ç°æœ‰æµ‹è¯•**: å·²æœ‰ 45 ä¸ªæµ‹è¯•ç±»

è¯·å‘Šè¯‰æˆ‘æ‚¨å¸Œæœ›ä¸ºå“ªäº›ç±»æˆ–åŠŸèƒ½ç¼–å†™/å®Œå–„å•å…ƒæµ‹è¯•ï¼Ÿ

æ‚¨å¯ä»¥ï¼š
1. æŒ‡å®šå…·ä½“ç±»åï¼Œå¦‚ï¼š`UserService`, `OrderController`
2. æŒ‡å®šåŒ…è·¯å¾„ï¼Œå¦‚ï¼š`com.example.service`
3. æŒ‡å®šåŠŸèƒ½æ¨¡å—ï¼Œå¦‚ï¼š`ç”¨æˆ·æ³¨å†ŒåŠŸèƒ½`ã€`è®¢å•å¤„ç†æ¨¡å—`
```

---

### é˜¶æ®µ 2: åˆ†æç¡®è®¤é˜¶æ®µï¼ˆç­‰å¾…ç”¨æˆ·ç¡®è®¤ï¼‰

#### 2.1 æ¥æ”¶ç”¨æˆ·è¾“å…¥å¹¶ç”Ÿæˆ taskId

ç”¨æˆ·æŒ‡å®šç›®æ ‡åï¼š
1. æ ¹æ®ç”¨æˆ·è¾“å…¥ç”Ÿæˆ taskId
2. åˆ›å»ºä»»åŠ¡ç›®å½• `./specs/test/[taskId]/`
3. æ‰§è¡Œä»£ç åˆ†æ

```
1. å®šä½ç›®æ ‡ç±»çš„æºæ–‡ä»¶
2. åˆ†æç±»çš„ä¾èµ–å…³ç³»
3. è¯†åˆ«æ‰€æœ‰ public æ–¹æ³•
4. æ£€æŸ¥æ˜¯å¦å·²æœ‰æµ‹è¯•ç±»
5. è¯„ä¼°æµ‹è¯•å¤æ‚åº¦
```

#### 2.2 è¾“å‡ºåˆ†æç»“æœï¼Œè¯·æ±‚ç¡®è®¤

```markdown
## ä»£ç åˆ†æå®Œæˆ

**ä»»åŠ¡ ID**: `user-service-20240115`
**æ–‡æ¡£ç›®å½•**: `./specs/test/user-service-20240115/`

æ ¹æ®æ‚¨çš„éœ€æ±‚ï¼Œæˆ‘åˆ†æäº†ä»¥ä¸‹ç±»ï¼š

### å¾…æµ‹è¯•ç±»æ¸…å•

| åºå· | ç±»å | è·¯å¾„ | public æ–¹æ³•æ•° | ç°æœ‰æµ‹è¯• | å»ºè®®ä¼˜å…ˆçº§ |
|------|------|------|---------------|----------|------------|
| 1 | UserService | com.example.service | 8 | æ—  | é«˜ |
| 2 | UserValidator | com.example.validator | 5 | éƒ¨åˆ†(2/5) | ä¸­ |
| 3 | UserRepository | com.example.repository | 6 | æ—  | ä½(æ¥å£) |

### ä¾èµ–å…³ç³»å›¾

```
UserService
â”œâ”€â”€ UserRepository (éœ€è¦ @Mock)
â”œâ”€â”€ UserValidator (éœ€è¦ @Mock)
â”œâ”€â”€ NotificationService (éœ€è¦ @Mock)
â””â”€â”€ UserParams.isBlacklisted() (éœ€è¦ mockStatic)
```

### å»ºè®®

- UserRepository æ˜¯æ¥å£ï¼Œå»ºè®®è·³è¿‡ï¼Œä»…ä½œä¸º Mock å¯¹è±¡
- UserValidator å·²æœ‰éƒ¨åˆ†æµ‹è¯•ï¼Œå»ºè®®è¡¥å……ç¼ºå¤±åœºæ™¯

**è¯·ç¡®è®¤ä»¥ä¸Šåˆ†ææ˜¯å¦æ­£ç¡®ï¼Œä»¥åŠæ‚¨å¸Œæœ›ä¸ºå“ªäº›ç±»ç”Ÿæˆæµ‹è¯•ï¼Ÿ**

å›å¤ç¤ºä¾‹ï¼š
- "ç¡®è®¤ï¼Œå…¨éƒ¨ç”Ÿæˆ"
- "åªéœ€è¦ UserService"
- "UserService å’Œ UserValidator"
```

> â›” **å¿…é¡»åœæ­¢**
>
> è¾“å‡ºä»¥ä¸Šå†…å®¹åï¼Œ**ç«‹å³åœæ­¢**ï¼Œä¸è¦ç»§ç»­æ‰§è¡Œä»»ä½•æ“ä½œã€‚
> ç­‰å¾…ç”¨æˆ·å›å¤ç¡®è®¤åï¼Œæ‰èƒ½è¿›å…¥é˜¶æ®µ 3ã€‚
> **ç¦æ­¢**åœ¨åŒä¸€è½®å¯¹è¯ä¸­ç»§ç»­ç”Ÿæˆ design.mdã€‚

---

### é˜¶æ®µ 3: æµ‹è¯•è®¾è®¡é˜¶æ®µï¼ˆç”Ÿæˆ design.mdï¼Œç­‰å¾…ç”¨æˆ· Reviewï¼‰

#### 3.1 ç”Ÿæˆæµ‹è¯•è®¾è®¡æ–‡æ¡£

ç”¨æˆ·ç¡®è®¤åï¼Œç”Ÿæˆ `./specs/test/[taskId]/design.md` æ–‡ä»¶ï¼š

```markdown
# æµ‹è¯•è®¾è®¡æ–‡æ¡£

> ä»»åŠ¡ ID: user-service-20240115
> åˆ›å»ºæ—¶é—´: 2024-01-15 10:30:00
> çŠ¶æ€: å¾… Review

## 1. UserService æµ‹è¯•è®¾è®¡

### 1.1 ç±»æ¦‚è¿°

- **ç±»è·¯å¾„**: `com.example.service.UserService`
- **èŒè´£**: ç”¨æˆ·æ³¨å†Œã€æŸ¥è¯¢ã€æ›´æ–°ã€åˆ é™¤ç­‰æ ¸å¿ƒä¸šåŠ¡é€»è¾‘
- **æµ‹è¯•ç±»**: `UserServiceTest`ï¼ˆæ–°å»ºï¼‰

### 1.2 ä¾èµ–åˆ†æ

| ä¾èµ– | ç±»å‹ | Mock ç­–ç•¥ |
|------|------|-----------|
| UserRepository | æ¥å£ | @Mock |
| UserValidator | ç±» | @Mock |
| NotificationService | æ¥å£ | @Mock |
| UserParams | é™æ€æ–¹æ³• | mockStatic |

### 1.3 æ–¹æ³•æµ‹è¯•çŸ©é˜µ

#### register(User user)

| åœºæ™¯ | è¾“å…¥æ¡ä»¶ | é¢„æœŸç»“æœ | ä¼˜å…ˆçº§ |
|------|----------|----------|--------|
| æ­£å¸¸æ³¨å†Œ | æœ‰æ•ˆç”¨æˆ·å¯¹è±¡ | ä¿å­˜æˆåŠŸï¼Œå‘é€é€šçŸ¥ | P0 |
| ç©ºç”¨æˆ·å | user.name = null | æŠ›å‡º IllegalArgumentException | P0 |
| ç©ºç”¨æˆ·å¯¹è±¡ | user = null | æŠ›å‡º IllegalArgumentException | P0 |
| é»‘åå•ç”¨æˆ· | UserParams.isBlacklisted = true | é™é»˜è¿”å›ï¼Œä¸ä¿å­˜ | P1 |
| é‡å¤ç”¨æˆ·å | ç”¨æˆ·åå·²å­˜åœ¨ | æŠ›å‡º DuplicateUserException | P1 |

#### getUser(Long id)

| åœºæ™¯ | è¾“å…¥æ¡ä»¶ | é¢„æœŸç»“æœ | ä¼˜å…ˆçº§ |
|------|----------|----------|--------|
| æ­£å¸¸æŸ¥è¯¢ | å­˜åœ¨çš„ç”¨æˆ· ID | è¿”å›ç”¨æˆ·å¯¹è±¡ | P0 |
| ç”¨æˆ·ä¸å­˜åœ¨ | ä¸å­˜åœ¨çš„ ID | æŠ›å‡º UserNotFoundException | P0 |
| ç©º ID | id = null | æŠ›å‡º IllegalArgumentException | P1 |

### 1.4 è¾¹ç•Œå€¼æµ‹è¯•æ¸…å•

- [ ] ç”¨æˆ·åé•¿åº¦ï¼š0, 1, 50, 51ï¼ˆå‡è®¾æœ€å¤§50ï¼‰
- [ ] ç”¨æˆ·å¹´é¾„ï¼š-1, 0, 1, 150, 151
- [ ] é‚®ç®±æ ¼å¼ï¼šnull, ç©ºå­—ç¬¦ä¸², æ— æ•ˆæ ¼å¼, æœ‰æ•ˆæ ¼å¼

### 1.5 æµ‹è¯•ç”¨ä¾‹æ•°é‡é¢„ä¼°

- æ€»è®¡ï¼šçº¦ 25 ä¸ªæµ‹è¯•ç”¨ä¾‹
- P0ï¼ˆå¿…é¡»ï¼‰ï¼š15 ä¸ª
- P1ï¼ˆé‡è¦ï¼‰ï¼š7 ä¸ª
- P2ï¼ˆå¯é€‰ï¼‰ï¼š3 ä¸ª

---

## 2. UserValidator æµ‹è¯•è®¾è®¡

ï¼ˆè¡¥å……ç¼ºå¤±çš„æµ‹è¯•åœºæ™¯ï¼‰

### 2.1 ç°æœ‰æµ‹è¯•è¦†ç›–

- âœ… validateName() - å·²è¦†ç›–
- âœ… validateEmail() - å·²è¦†ç›–
- âŒ validateAge() - æœªè¦†ç›–
- âŒ validatePhone() - æœªè¦†ç›–
- âŒ validateAll() - æœªè¦†ç›–

### 2.2 å¾…è¡¥å……æµ‹è¯•çŸ©é˜µ

#### validateAge(int age)

| åœºæ™¯ | è¾“å…¥æ¡ä»¶ | é¢„æœŸç»“æœ | ä¼˜å…ˆçº§ |
|------|----------|----------|--------|
| æœ‰æ•ˆå¹´é¾„ | age = 25 | è¿”å› true | P0 |
| è¾¹ç•Œå€¼-ä¸‹é™ | age = 0 | è¿”å› true | P0 |
| è¾¹ç•Œå€¼-ä¸Šé™ | age = 150 | è¿”å› true | P0 |
| æ— æ•ˆ-è´Ÿæ•° | age = -1 | è¿”å› false | P0 |
| æ— æ•ˆ-è¶…é™ | age = 151 | è¿”å› false | P0 |
```

#### 3.2 è¯·æ±‚ç”¨æˆ· Review

```markdown
## æµ‹è¯•è®¾è®¡æ–‡æ¡£å·²ç”Ÿæˆ

ğŸ“„ æ–‡ä»¶: `./specs/test/user-service-20240115/design.md`

**è¯· Review ä»¥ä¸Šæµ‹è¯•è®¾è®¡æ–‡æ¡£ï¼š**

1. æµ‹è¯•åœºæ™¯æ˜¯å¦è¦†ç›–äº†æ‚¨å…³å¿ƒçš„ä¸šåŠ¡é€»è¾‘ï¼Ÿ
2. æ˜¯å¦æœ‰éœ€è¦å¢åŠ æˆ–åˆ é™¤çš„æµ‹è¯•åœºæ™¯ï¼Ÿ
3. ä¼˜å…ˆçº§åˆ’åˆ†æ˜¯å¦åˆç†ï¼Ÿ

å›å¤ç¤ºä¾‹ï¼š
- "ç¡®è®¤ï¼Œå¯ä»¥ç»§ç»­"
- "register æ–¹æ³•éœ€è¦å¢åŠ å¹¶å‘æ³¨å†Œçš„åœºæ™¯"
- "P2 çš„æµ‹è¯•å¯ä»¥å…ˆä¸åš"
```

> â›” **å¿…é¡»åœæ­¢**
>
> ç”Ÿæˆ design.md å¹¶è¾“å‡ºä»¥ä¸Šå†…å®¹åï¼Œ**ç«‹å³åœæ­¢**ï¼Œä¸è¦ç»§ç»­æ‰§è¡Œä»»ä½•æ“ä½œã€‚
> ç­‰å¾…ç”¨æˆ· Review é€šè¿‡åï¼Œæ‰èƒ½è¿›å…¥é˜¶æ®µ 4ã€‚
> **ç¦æ­¢**åœ¨åŒä¸€è½®å¯¹è¯ä¸­ç»§ç»­ç”Ÿæˆ plan.md æˆ–ç¼–å†™æµ‹è¯•ä»£ç ã€‚

---

### é˜¶æ®µ 4: å®æ–½è®¡åˆ’é˜¶æ®µï¼ˆç”Ÿæˆ plan.mdï¼Œç­‰å¾…ç”¨æˆ· Reviewï¼‰

#### 4.1 ç”Ÿæˆå®æ–½è®¡åˆ’æ–‡æ¡£

ç”¨æˆ·ç¡®è®¤è®¾è®¡æ–‡æ¡£åï¼Œç”Ÿæˆ `./specs/test/[taskId]/plan.md` æ–‡ä»¶ï¼š

```markdown
# æµ‹è¯•å®æ–½è®¡åˆ’

> ä»»åŠ¡ ID: user-service-20240115
> åˆ›å»ºæ—¶é—´: 2024-01-15 10:45:00
> çŠ¶æ€: å¾… Review

## æ‰§è¡Œæ¸…å•

æŒ‰ç…§ä¾èµ–å…³ç³»å’Œä¼˜å…ˆçº§ï¼ŒæŒ‰ä»¥ä¸‹é¡ºåºå®æ–½ï¼š

### 1. UserServiceTestï¼ˆæ–°å»ºï¼‰

- [ ] 1.1 åˆ›å»ºæµ‹è¯•ç±»éª¨æ¶å’Œ Mock é…ç½®
- [ ] 1.2 register() æ–¹æ³•æµ‹è¯•ï¼ˆ5 ä¸ªç”¨ä¾‹ï¼‰
  - [ ] 1.2.1 shouldSaveUser_whenUserIsValid
  - [ ] 1.2.2 shouldThrowException_whenUserIsNull
  - [ ] 1.2.3 shouldThrowException_whenNameIsNull
  - [ ] 1.2.4 shouldNotSaveUser_whenUserIsBlacklisted
  - [ ] 1.2.5 shouldThrowException_whenUserNameDuplicated
- [ ] 1.3 getUser() æ–¹æ³•æµ‹è¯•ï¼ˆ3 ä¸ªç”¨ä¾‹ï¼‰
  - [ ] 1.3.1 shouldReturnUser_whenUserExists
  - [ ] 1.3.2 shouldThrowException_whenUserNotFound
  - [ ] 1.3.3 shouldThrowException_whenIdIsNull
- [ ] 1.4 updateUser() æ–¹æ³•æµ‹è¯•ï¼ˆ4 ä¸ªç”¨ä¾‹ï¼‰
  - [ ] 1.4.1 ...
  - [ ] 1.4.2 ...
  - [ ] 1.4.3 ...
  - [ ] 1.4.4 ...
- [ ] 1.5 deleteUser() æ–¹æ³•æµ‹è¯•ï¼ˆ3 ä¸ªç”¨ä¾‹ï¼‰
  - [ ] 1.5.1 ...
  - [ ] 1.5.2 ...
  - [ ] 1.5.3 ...

### 2. UserValidatorTestï¼ˆè¡¥å……ï¼‰

- [ ] 2.1 validateAge() æ–¹æ³•æµ‹è¯•ï¼ˆ5 ä¸ªç”¨ä¾‹ï¼‰
  - [ ] 2.1.1 shouldReturnTrue_whenAgeIsValid
  - [ ] 2.1.2 shouldReturnTrue_whenAgeIsZero
  - [ ] 2.1.3 shouldReturnTrue_whenAgeIsMaxValid
  - [ ] 2.1.4 shouldReturnFalse_whenAgeIsNegative
  - [ ] 2.1.5 shouldReturnFalse_whenAgeExceedsMax
- [ ] 2.2 validatePhone() æ–¹æ³•æµ‹è¯•ï¼ˆ4 ä¸ªç”¨ä¾‹ï¼‰
  - [ ] 2.2.1 ...
  - [ ] 2.2.2 ...
  - [ ] 2.2.3 ...
  - [ ] 2.2.4 ...
- [ ] 2.3 validateAll() æ–¹æ³•æµ‹è¯•ï¼ˆ3 ä¸ªç”¨ä¾‹ï¼‰
  - [ ] 2.3.1 ...
  - [ ] 2.3.2 ...
  - [ ] 2.3.3 ...

## æ–‡ä»¶å˜æ›´é¢„è§ˆ

| æ“ä½œ | æ–‡ä»¶è·¯å¾„ | è¯´æ˜ |
|------|----------|------|
| æ–°å»º | src/test/java/com/example/service/UserServiceTest.java | çº¦ 300 è¡Œ |
| ä¿®æ”¹ | src/test/java/com/example/validator/UserValidatorTest.java | æ–°å¢çº¦ 100 è¡Œ |

## é¢„è®¡æµ‹è¯•ç”¨ä¾‹

- æ–°å¢æµ‹è¯•ç”¨ä¾‹ï¼š27 ä¸ª
- æ–°å¢ä»£ç è¡Œæ•°ï¼šçº¦ 400 è¡Œ
```

#### 4.2 è¯·æ±‚ç”¨æˆ· Review

```markdown
## å®æ–½è®¡åˆ’å·²ç”Ÿæˆ

ğŸ“„ æ–‡ä»¶: `./specs/test/user-service-20240115/plan.md`

**è¯·ç¡®è®¤å®æ–½è®¡åˆ’ï¼š**

1. æ‰§è¡Œé¡ºåºæ˜¯å¦éœ€è¦è°ƒæ•´ï¼Ÿ
2. æ˜¯å¦å¯ä»¥å¼€å§‹ç¼–å†™æµ‹è¯•ä»£ç ï¼Ÿ

å›å¤ç¤ºä¾‹ï¼š
- "ç¡®è®¤ï¼Œå¼€å§‹ç¼–å†™"
- "å…ˆåªåš UserServiceTest"
- "register æ–¹æ³•çš„æµ‹è¯•ä¼˜å…ˆ"
```

> â›” **å¿…é¡»åœæ­¢**
>
> ç”Ÿæˆ plan.md å¹¶è¾“å‡ºä»¥ä¸Šå†…å®¹åï¼Œ**ç«‹å³åœæ­¢**ï¼Œä¸è¦ç»§ç»­æ‰§è¡Œä»»ä½•æ“ä½œã€‚
> ç­‰å¾…ç”¨æˆ·æ˜ç¡®æŒ‡ç¤º"å¼€å§‹ç¼–å†™"æˆ–ç±»ä¼¼ç¡®è®¤åï¼Œæ‰èƒ½è¿›å…¥é˜¶æ®µ 5ã€‚
> **ç¦æ­¢**åœ¨åŒä¸€è½®å¯¹è¯ä¸­å¼€å§‹ç¼–å†™ä»»ä½•æµ‹è¯•ä»£ç ã€‚

---

### é˜¶æ®µ 5: ç¼–å†™ä»£ç é˜¶æ®µï¼ˆæ‰§è¡Œå¹¶å®æ—¶æ›´æ–° plan.mdï¼‰

#### 5.1 æŒ‰è®¡åˆ’é€æ­¥å®æ–½

ç”¨æˆ·ç¡®è®¤åï¼ŒæŒ‰ç…§ plan.md ä¸­çš„æ¸…å•é€ä¸ªç¼–å†™æµ‹è¯•ã€‚

**é‡è¦ï¼šæ¯å®Œæˆä¸€ä¸ªä»»åŠ¡é¡¹ï¼Œç«‹å³æ›´æ–° plan.mdï¼Œå°† `[ ]` æ”¹ä¸º `[x]`**

ç¤ºä¾‹ï¼šå®Œæˆ `1.1 åˆ›å»ºæµ‹è¯•ç±»éª¨æ¶` åï¼Œæ›´æ–° plan.mdï¼š

```markdown
### 1. UserServiceTestï¼ˆæ–°å»ºï¼‰

- [x] 1.1 åˆ›å»ºæµ‹è¯•ç±»éª¨æ¶å’Œ Mock é…ç½®  âœ… 2024-01-15 11:00
- [ ] 1.2 register() æ–¹æ³•æµ‹è¯•ï¼ˆ5 ä¸ªç”¨ä¾‹ï¼‰
  ...
```

#### 5.2 å®æ—¶è¿›åº¦åé¦ˆ

æ¯å®Œæˆä¸€ä¸ªä¸»è¦ä»»åŠ¡é¡¹ï¼ˆå¦‚ä¸€ä¸ªæ–¹æ³•çš„æ‰€æœ‰æµ‹è¯•ï¼‰ï¼Œå‘ç”¨æˆ·æ±‡æŠ¥è¿›åº¦ï¼š

```markdown
## è¿›åº¦æ›´æ–°

âœ… å·²å®Œæˆ: 1.2 register() æ–¹æ³•æµ‹è¯•ï¼ˆ5 ä¸ªç”¨ä¾‹ï¼‰
ğŸ“„ plan.md å·²æ›´æ–°

å½“å‰è¿›åº¦: 2/5 (UserServiceTest)

ç»§ç»­æ‰§è¡Œä¸‹ä¸€é¡¹: 1.3 getUser() æ–¹æ³•æµ‹è¯•...
```

#### 5.3 é˜¶æ®µæ€§ç¡®è®¤ï¼ˆå¯é€‰ï¼‰

å¯¹äºå¤§å‹æµ‹è¯•ä»»åŠ¡ï¼Œå¯ä»¥åœ¨å®Œæˆæ¯ä¸ªç±»çš„æµ‹è¯•åæš‚åœç¡®è®¤ï¼š

```markdown
## UserServiceTest ç¼–å†™å®Œæˆ

- æ–‡ä»¶: src/test/java/com/example/service/UserServiceTest.java
- æµ‹è¯•ç”¨ä¾‹: 15 ä¸ª
- ä»£ç è¡Œæ•°: 280 è¡Œ

ğŸ“„ plan.md è¿›åº¦:
- [x] 1. UserServiceTestï¼ˆæ–°å»ºï¼‰- å…¨éƒ¨å®Œæˆ
- [ ] 2. UserValidatorTestï¼ˆè¡¥å……ï¼‰- å¾…å¼€å§‹

**æ˜¯å¦ç»§ç»­ç¼–å†™ UserValidatorTestï¼Ÿ**
```

#### 5.4 å®Œæˆæ€»ç»“

å…¨éƒ¨å®Œæˆåï¼Œæ›´æ–° plan.md çŠ¶æ€å¹¶è¾“å‡ºæ€»ç»“æŠ¥å‘Šï¼š

æ›´æ–° plan.md å¤´éƒ¨çŠ¶æ€ï¼š
```markdown
> çŠ¶æ€: âœ… å·²å®Œæˆ
> å®Œæˆæ—¶é—´: 2024-01-15 12:30:00
```

è¾“å‡ºæ€»ç»“ï¼š
```markdown
## æµ‹è¯•ç¼–å†™å®Œæˆ

### å˜æ›´æ±‡æ€»

| æ–‡ä»¶ | æ“ä½œ | æµ‹è¯•ç”¨ä¾‹æ•° | ä»£ç è¡Œæ•° |
|------|------|------------|----------|
| UserServiceTest.java | æ–°å»º | 15 | 280 |
| UserValidatorTest.java | ä¿®æ”¹ | 12 | 95 |

### ä»»åŠ¡æ–‡æ¡£

- ğŸ“„ è®¾è®¡æ–‡æ¡£: `./specs/test/user-service-20240115/design.md`
- ğŸ“„ å®æ–½è®¡åˆ’: `./specs/test/user-service-20240115/plan.md`ï¼ˆå·²å…¨éƒ¨å®Œæˆï¼‰

### è¿è¡Œæµ‹è¯•

è¯·æ‰§è¡Œä»¥ä¸‹å‘½ä»¤éªŒè¯æµ‹è¯•ï¼š

```bash
mvn test -Dtest=UserServiceTest,UserValidatorTest
```

### åç»­å»ºè®®

1. è¿è¡Œæµ‹è¯•ç¡®ä¿å…¨éƒ¨é€šè¿‡
2. æ£€æŸ¥æµ‹è¯•è¦†ç›–ç‡æŠ¥å‘Š
3. å¦‚æœ‰å¤±è´¥ç”¨ä¾‹ï¼Œè¯·å‘ŠçŸ¥æˆ‘è¿›è¡Œè°ƒæ•´
```

---

## æŠ€æœ¯è§„èŒƒ

### 1. æŠ€æœ¯æ ˆçº¦æŸ

#### 1.1 å¿…é¡»ä½¿ç”¨

| ç±»åˆ« | æŠ€æœ¯é€‰å‹ | ç‰ˆæœ¬è¦æ±‚ |
|------|----------|----------|
| è¯­è¨€ | Java | 8+ï¼ˆæ¨è 17+ï¼‰ |
| æµ‹è¯•æ¡†æ¶ | JUnit 5 (Jupiter) | 5.x |
| Mock æ¡†æ¶ | Mockito | 4+ï¼ˆJava 8ï¼‰æˆ– 5+ï¼ˆJava 11+ï¼‰ |
| æ–­è¨€åº“ | AssertJ | 3.x |

#### 1.2 ç¦æ­¢ä½¿ç”¨

- JUnit 4 çš„ç±»ï¼ˆ`org.junit.Test`, `@RunWith`ï¼‰
- PowerMock
- JUnit åŸç”Ÿæ–­è¨€ï¼ˆ`assertEquals`, `assertTrue`ï¼‰

#### 1.3 ç‰ˆæœ¬é€‚é…

æ ¹æ®é¡¹ç›® Java ç‰ˆæœ¬è‡ªåŠ¨è°ƒæ•´ä»£ç é£æ ¼ï¼š

| Java ç‰ˆæœ¬ | ä»£ç é£æ ¼ |
|-----------|----------|
| 8 | æ˜¾å¼ç±»å‹å£°æ˜ï¼ŒLambda è¡¨è¾¾å¼ |
| 11+ | å¯ä½¿ç”¨ `var` å±€éƒ¨å˜é‡æ¨æ–­ |
| 17+ | å¯ä½¿ç”¨ Recordã€Text Blocks |

---

### 2. å‘½åè§„èŒƒ

#### 2.1 æµ‹è¯•ç±»å

```
{è¢«æµ‹ç±»å}Test
```

#### 2.2 æµ‹è¯•æ–¹æ³•å

ä½¿ç”¨ BDD é£æ ¼ï¼š

```
should{é¢„æœŸè¡Œä¸º}_when{æ¡ä»¶æˆ–çŠ¶æ€}
```

ç¤ºä¾‹ï¼š
- `shouldThrowException_whenNameIsNull`
- `shouldReturnEmptyList_whenNoDataFound`

#### 2.3 @DisplayName

å¿…é¡»ä½¿ç”¨ä¸­æ–‡æè¿°ï¼š

```java
@DisplayName("å½“ç”¨æˆ·åä¸ºç©ºæ—¶ï¼Œåº”æŠ›å‡º IllegalArgumentException")
```

---

### 3. ä»£ç ç»“æ„è§„èŒƒ

#### 3.1 æµ‹è¯•ç±»ç»“æ„

```java
@ExtendWith(MockitoExtension.class)
class XxxServiceTest {

    // 1. Mock ä¾èµ–
    @Mock
    private UserRepository userRepository;

    // 2. è¢«æµ‹å¯¹è±¡
    @InjectMocks
    private XxxService xxxService;

    // 3. ä½¿ç”¨ @Nested åˆ†ç»„
    @Nested
    @DisplayName("register æ–¹æ³•æµ‹è¯•")
    class RegisterTests {
        // æµ‹è¯•æ–¹æ³•
    }
}
```

#### 3.2 æµ‹è¯•æ–¹æ³•ç»“æ„ï¼ˆAAA æ¨¡å¼ï¼‰

```java
@Test
@DisplayName("å½“ç”¨æˆ·æœ‰æ•ˆæ—¶ï¼Œåº”ä¿å­˜ç”¨æˆ·")
void shouldSaveUser_whenUserIsValid() {
    // Arrange - å‡†å¤‡
    var user = new User("å¼ ä¸‰", 25);
    when(userRepository.save(any())).thenReturn(user);

    // Act - æ‰§è¡Œ
    var result = userService.register(user);

    // Assert - æ–­è¨€
    assertThat(result).isNotNull();
    verify(userRepository).save(user);
}
```

---

### 4. Mock ä½¿ç”¨è§„èŒƒ

#### 4.1 @Mock vs @Spy

| æ³¨è§£ | ä½¿ç”¨åœºæ™¯ |
|------|----------|
| `@Mock` | å®Œå…¨æ¨¡æ‹Ÿï¼Œéœ€å®šä¹‰è¿”å›å€¼ |
| `@Spy` | éƒ¨åˆ†æ¨¡æ‹Ÿï¼Œé»˜è®¤è°ƒç”¨çœŸå®æ–¹æ³• |

#### 4.2 é™æ€æ–¹æ³• Mock

å¿…é¡»ä½¿ç”¨ try-with-resourcesï¼š

```java
try (MockedStatic<UserParams> mocked = mockStatic(UserParams.class)) {
    mocked.when(() -> UserParams.isBlacklisted("test")).thenReturn(true);
    // Act & Assert
}
```

#### 4.3 void æ–¹æ³• Mock

```java
doNothing().when(mockService).sendEmail(any());
doThrow(new RuntimeException()).when(mockService).sendEmail(any());
```

#### 4.4 ArgumentCaptor

```java
ArgumentCaptor<User> captor = ArgumentCaptor.forClass(User.class);
verify(repository).save(captor.capture());
assertThat(captor.getValue().getName()).isEqualTo("å¼ ä¸‰");
```

---

### 5. å‚æ•°åŒ–æµ‹è¯•

```java
@ParameterizedTest
@CsvSource({
    "0, true",
    "-1, false",
    "150, true",
    "151, false"
})
@DisplayName("å¹´é¾„æœ‰æ•ˆæ€§æ ¡éªŒ")
void shouldValidateAge(int age, boolean expected) {
    assertThat(validator.isValidAge(age)).isEqualTo(expected);
}
```

---

### 6. æµ‹è¯•æœ‰æ•ˆæ€§çº¦æŸï¼ˆä¸¥æ ¼æ‰§è¡Œï¼‰

#### 6.1 æµ‹è¯•æ–¹æ³•å¿…è¦ç»“æ„

æ¯ä¸ªæµ‹è¯•æ–¹æ³•**å¿…é¡»åŒæ—¶åŒ…å«**ä»¥ä¸‹å…ƒç´ ï¼Œç¼ºä¸€ä¸å¯ï¼š

```java
@Test
@DisplayName("...")
void shouldXxx_whenYyy() {
    // âœ… å¿…é¡»ï¼šå‡†å¤‡æµ‹è¯•æ•°æ®
    var input = ...;

    // âœ… å¿…é¡»ï¼šè°ƒç”¨è¢«æµ‹æ–¹æ³•ï¼ˆActï¼‰
    var result = targetService.methodUnderTest(input);  // å¿…é¡»å®é™…è°ƒç”¨ï¼

    // âœ… å¿…é¡»ï¼šè‡³å°‘ä¸€ä¸ªæœ‰æ„ä¹‰çš„æ–­è¨€
    assertThat(result).isEqualTo(expected);  // å¿…é¡»éªŒè¯ç»“æœï¼

    // âœ… å¿…é¡»ï¼ˆå¦‚æœ‰ Mockï¼‰ï¼šéªŒè¯å…³é”®äº¤äº’
    verify(mockDependency).expectedMethod(input);  // å¿…é¡»éªŒè¯è°ƒç”¨ï¼
}
```

#### 6.2 ç¦æ­¢çš„åæ¨¡å¼ï¼ˆç»å¯¹ç¦æ­¢ï¼‰

ä»¥ä¸‹å†™æ³•**ä¸¥æ ¼ç¦æ­¢**ï¼Œä¸€æ—¦å‘ç°å¿…é¡»ç«‹å³ä¿®æ­£ï¼š

##### âŒ ç©ºæµ‹è¯•æ–¹æ³•

```java
// ç¦æ­¢ï¼šæ²¡æœ‰ä»»ä½•æ–­è¨€æˆ–éªŒè¯
@Test
void shouldDoSomething() {
    // ç©ºæ–¹æ³•ä½“æˆ–åªæœ‰æ³¨é‡Š
}
```

##### âŒ ä¸è°ƒç”¨è¢«æµ‹æ–¹æ³•

```java
// ç¦æ­¢ï¼šæ²¡æœ‰è°ƒç”¨è¢«æµ‹å¯¹è±¡çš„æ–¹æ³•
@Test
void shouldSaveUser() {
    var user = new User("test");
    // ç¼ºå°‘: userService.save(user);
    assertThat(user).isNotNull();  // è¿™ä¸æ˜¯æµ‹è¯•ï¼
}
```

##### âŒ æ— æ„ä¹‰çš„æ–­è¨€

```java
// ç¦æ­¢ï¼šæ–­è¨€ä¸éªŒè¯è¢«æµ‹æ–¹æ³•çš„è¡Œä¸º
@Test
void shouldReturnUser() {
    var result = userService.getUser(1L);
    assertThat(result).isNotNull();  // å¤ªå¼±ï¼å¿…é¡»éªŒè¯å…·ä½“å†…å®¹
    assertThat(true).isTrue();       // ç¦æ­¢ï¼šæ’çœŸæ–­è¨€
    assertThat(1).isEqualTo(1);      // ç¦æ­¢ï¼šä¸è¢«æµ‹ä»£ç æ— å…³
}
```

##### âŒ å¿…ç„¶é€šè¿‡çš„ verify

```java
// ç¦æ­¢ï¼šè¿™äº› verify æ°¸è¿œé€šè¿‡ï¼Œæ¯«æ— æ„ä¹‰
verify(mock, atLeast(0)).anyMethod();     // ç¦æ­¢ï¼š0æ¬¡ä¹Ÿé€šè¿‡
verify(mock, atMost(999)).anyMethod();    // ç¦æ­¢ï¼šå½¢åŒè™šè®¾
verifyNoMoreInteractions();               // ç¦æ­¢ï¼šå•ç‹¬ä½¿ç”¨æ— æ„ä¹‰
```

##### âŒ åª Mock ä¸éªŒè¯

```java
// ç¦æ­¢ï¼šè®¾ç½®äº† Mock ä½†ä¸éªŒè¯æ˜¯å¦è¢«è°ƒç”¨
@Test
void shouldNotifyUser() {
    when(notificationService.send(any())).thenReturn(true);
    userService.register(user);
    // ç¼ºå°‘: verify(notificationService).send(any());
}
```

##### âŒ æ•è·å¼‚å¸¸åä¸éªŒè¯

```java
// ç¦æ­¢ï¼šåæ‰å¼‚å¸¸
@Test
void shouldThrowException() {
    try {
        userService.getUser(null);
    } catch (Exception e) {
        // ç¦æ­¢ï¼šæ•è·åä»€ä¹ˆéƒ½ä¸åš
    }
}
```

##### âŒ æ–­è¨€è¾“å…¥è€Œéè¾“å‡º

```java
// ç¦æ­¢ï¼šæ–­è¨€çš„æ˜¯è¾“å…¥æ•°æ®ï¼Œä¸æ˜¯æ–¹æ³•è¿”å›
@Test
void shouldProcessOrder() {
    var order = new Order(100);
    orderService.process(order);
    assertThat(order.getAmount()).isEqualTo(100);  // ç¦æ­¢ï¼šéªŒè¯çš„æ˜¯è¾“å…¥ï¼
}
```

#### 6.3 æ­£ç¡®å†™æ³•å¯¹ç…§è¡¨

| åœºæ™¯ | âŒ é”™è¯¯å†™æ³• | âœ… æ­£ç¡®å†™æ³• |
|------|------------|------------|
| è¿”å›å€¼æµ‹è¯• | `assertThat(result).isNotNull()` | `assertThat(result.getName()).isEqualTo("å¼ ä¸‰")` |
| void æ–¹æ³• | æ—  verify | `verify(repository).save(argThat(u -> u.getName().equals("å¼ ä¸‰")))` |
| å¼‚å¸¸æµ‹è¯• | try-catch åå¼‚å¸¸ | `assertThatThrownBy(() -> ...).isInstanceOf(XxxException.class)` |
| Mock éªŒè¯ | `verify(mock, atLeast(0))` | `verify(mock, times(1))` æˆ– `verify(mock)` |
| çŠ¶æ€å˜æ›´ | åªéªŒè¯è¿”å›å€¼ | åŒæ—¶éªŒè¯ `verify` å’Œ `ArgumentCaptor` |

#### 6.4 æ¯ä¸ªæµ‹è¯•å¿…é¡»å›ç­”çš„é—®é¢˜

ç¼–å†™æµ‹è¯•æ—¶ï¼Œç¡®ä¿èƒ½æ˜ç¡®å›ç­”ä»¥ä¸‹é—®é¢˜ï¼š

1. **è°ƒç”¨äº†ä»€ä¹ˆï¼Ÿ** - è¢«æµ‹æ–¹æ³•æ˜¯å¦è¢«å®é™…è°ƒç”¨
2. **ä¼ å…¥äº†ä»€ä¹ˆï¼Ÿ** - è¾“å…¥å‚æ•°æ˜¯å¦æ­£ç¡®ä¼ é€’ç»™ä¾èµ–
3. **è¿”å›äº†ä»€ä¹ˆï¼Ÿ** - è¿”å›å€¼æ˜¯å¦ç¬¦åˆé¢„æœŸ
4. **å‘ç”Ÿäº†ä»€ä¹ˆï¼Ÿ** - å‰¯ä½œç”¨ï¼ˆæ•°æ®åº“ä¿å­˜ã€æ¶ˆæ¯å‘é€ï¼‰æ˜¯å¦å‘ç”Ÿ

```java
// å®Œæ•´ç¤ºä¾‹ï¼šå›ç­”æ‰€æœ‰é—®é¢˜
@Test
@DisplayName("å½“ç”¨æˆ·æœ‰æ•ˆæ—¶ï¼Œåº”ä¿å­˜ç”¨æˆ·å¹¶å‘é€æ¬¢è¿é‚®ä»¶")
void shouldSaveUserAndSendEmail_whenUserIsValid() {
    // Arrange
    var user = new User("å¼ ä¸‰", "zhangsan@example.com");
    when(userRepository.save(any())).thenAnswer(inv -> inv.getArgument(0));

    // Act - å›ç­”"è°ƒç”¨äº†ä»€ä¹ˆ"
    var result = userService.register(user);

    // Assert - å›ç­”"è¿”å›äº†ä»€ä¹ˆ"
    assertThat(result.getId()).isNotNull();
    assertThat(result.getName()).isEqualTo("å¼ ä¸‰");

    // Verify - å›ç­”"ä¼ å…¥äº†ä»€ä¹ˆ"å’Œ"å‘ç”Ÿäº†ä»€ä¹ˆ"
    ArgumentCaptor<User> userCaptor = ArgumentCaptor.forClass(User.class);
    verify(userRepository).save(userCaptor.capture());
    assertThat(userCaptor.getValue().getName()).isEqualTo("å¼ ä¸‰");

    verify(emailService).sendWelcomeEmail("zhangsan@example.com");
}
```

---

### 7. è´¨é‡è‡ªæ£€æ¸…å•

ç”Ÿæˆæµ‹è¯•åï¼Œ**å¿…é¡»**å¯¹ç…§ä»¥ä¸‹æ¸…å•é€é¡¹æ£€æŸ¥ï¼š

#### æœ‰æ•ˆæ€§æ£€æŸ¥ï¼ˆæœ€é‡è¦ï¼‰
- [ ] æ¯ä¸ªæµ‹è¯•éƒ½è°ƒç”¨äº†è¢«æµ‹æ–¹æ³•
- [ ] æ¯ä¸ªæµ‹è¯•éƒ½æœ‰éªŒè¯è¿”å›å€¼æˆ–è¡Œä¸ºçš„æ–­è¨€
- [ ] æ²¡æœ‰ç©ºæµ‹è¯•æ–¹æ³•
- [ ] æ²¡æœ‰æ’çœŸæ–­è¨€ï¼ˆå¦‚ `assertThat(true).isTrue()`ï¼‰
- [ ] æ²¡æœ‰ `verify(mock, atLeast(0))` ç­‰æ— æ„ä¹‰éªŒè¯
- [ ] Mock è®¾ç½®åéƒ½æœ‰å¯¹åº”çš„ verify

#### è¦†ç›–åº¦æ£€æŸ¥
- [ ] æ‰€æœ‰ public æ–¹æ³•éƒ½æœ‰æµ‹è¯•
- [ ] æ‰€æœ‰åˆ†æ”¯éƒ½è¢«è¦†ç›–
- [ ] null/ç©ºå€¼/è¾¹ç•Œå€¼å·²æµ‹è¯•
- [ ] å¼‚å¸¸è·¯å¾„å·²æµ‹è¯•

#### ä»£ç è´¨é‡æ£€æŸ¥
- [ ] å‘½åç¬¦åˆ `should_when` è§„èŒƒ
- [ ] æ‰€æœ‰æ–¹æ³•éƒ½æœ‰ `@DisplayName`
- [ ] éµå¾ª AAA æ¨¡å¼
- [ ] é™æ€æ–¹æ³• Mock ä½¿ç”¨ try-with-resources

#### ç‹¬ç«‹æ€§æ£€æŸ¥
- [ ] æµ‹è¯•ä¹‹é—´æ— é¡ºåºä¾èµ–
- [ ] æ²¡æœ‰å…±äº«å¯å˜çŠ¶æ€

---

## é™„å½• Aï¼šAssertJ å¸¸ç”¨æ–­è¨€é€ŸæŸ¥

```java
// åŸºæœ¬
assertThat(result).isEqualTo(expected);
assertThat(result).isNotNull();

// å­—ç¬¦ä¸²
assertThat(str).contains("å…³é”®è¯");
assertThat(str).startsWith("å‰ç¼€");

// æ•°å­—
assertThat(num).isGreaterThan(0);
assertThat(num).isBetween(1, 100);

// é›†åˆ
assertThat(list).hasSize(3);
assertThat(list).extracting(User::getName).containsExactly("å¼ ä¸‰", "æå››");

// å¼‚å¸¸
assertThatThrownBy(() -> method())
    .isInstanceOf(SomeException.class)
    .hasMessage("é”™è¯¯ä¿¡æ¯");

// Optional
assertThat(optional).isPresent();
assertThat(optional).hasValue(expected);
```
